<!--
BET-COET 2021-2023
Programmers:
        Trisha Eunis Elicot
        Dana Grace Fulla
        Allora Blesse Lagura
        Jazminn Aira Terencio
Adviser:
        Mr.Jay Victor Gumboc
-->

<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="icon" href="{% static 'Media/tup_logo.png' %}">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

    <title>Request Form List</title>

    <script type="text/javascript">
        function preventBack() {
            window.history.forward();
        }
        setTimeout("preventBack()", 0);
        window.onunload = function() {
            null
        };
    </script>

</head>


<style>
    a {
        font-style: italic;
        color: #000;
    }

    a :hover {
        color: #fff;
    }

    button {
        border-radius: 10px;
        background-color: #c51d3a;
        color: white;
    }
    
    button.list_tbl {
        background-color: #c51d3a;
    }

    footer {
        position: fixed;
        bottom: 0;
        width: 100%;
        text-align: center;
        height: 40 px;
        background: #424242;
        color: white;
        padding-top: 10px;
    }
    
    h1 {
        padding-left: 15px;
        font-weight: bolder;
    }
    
    hr {
        border-top: 2px solid black;
    }
    
    i {
        padding-left: 10px;
    }
    
    p1 {
        font-size: 30px;
    }
    
    p2 {
        font-size: 20px;
        font-weight: bolder;
    }

    table{
        min-width: max-content;
        border-collapse: separate;
    }

    #list_tbl_77 td:nth-child(2) {

        border-collapse: separate;
        border-spacing: 0px;
        border-right-width: 0;
    }


    thead{
        position: sticky;
        top: 0px;
        z-index: 1;
    }

    thead,td{
        padding: 5px;
        overflow-wrap: break-word;
    }

    tr:hover td {
        background-color: #636363;
        color: #fff;
    }

    .btn {
        border-radius: 10px;
        background-color: #c51d3a;
        color: white;
    }

    .counter {
        padding: 8px;
        color: #ccc;
    }

    .dropdown-item:hover{
        background-color:#c51d3a;
        border:#ffff;
        color: #ffff;
        
    }
    
    .dropdown-submenu {
        position: relative;
    }
    
    .dropdown-submenu .dropdown-menu {
    top: 0;
    left: 100%;
    margin-top: -1px;
    }

    .outer-wrapper{
        margin: 10px;
    }

    .results tr[visible='false'],
    .no-result {
        display: none;
    }
    
    .results tr[visible='true'] {
        display: table-row;
    }

    .results2 tr[visible='false'],
    .no-result2 {
        display: none;
    }
    
    .results2 tr[visible='true'] {
        display: table-row;
    }

    .tab {
        text-decoration: none;
        color: inherit;
        padding: 7px 14px;
        transition: opacity 0.3s;
        display: inline-block;
        border-radius: 3px;
        margin-right: 10px;
        margin-left: 20px;
    }
    
    .tab:hover {
        color: #c51d3a;
    }
    
    .tab-content {
        padding: 6px 12px;
        min-height: 100px;
        animation: fadeEffect 1s;
        padding-bottom: 50px;
    }

    .table-icon {
        background-color: #dedede;
        color: #000;
        align-content: center;
    }

    .table-i{
        padding: 0%;
    }

    .table-sortable th {
        cursor: pointer;
        table-layout: fixed;
    }
    
    .sorting::after{
        display: inline;
        font-family:FontAwesome;
        content:"\f0dc";
        color: white;
        font-size: 12px;
        margin-left:3px;
    }
    
    .table-sortable .th-sort-asc::after {
        display: inline;
        content: "\25b4";
        color: white;
    }
    
    .table-sortable .th-sort-desc::after {
        display: inline;
        content: "\25be";
        color: white;
    }
    
    .table-sortable .th-sort-asc::after,
    .table-sortable .th-sort-desc::after {
        margin-left: 5px;
    }
    
    .table-sortable .th-sort-asc,
    .table-sortable .th-sort-desc {
        background: rgba(0, 0, 0, 0.1);
    }

    .dropdown-menu>li{	
        position:relative;
        -webkit-user-select: none; /* Chrome/Safari */        
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* IE10+ */
        /* Rules below not implemented in browsers yet */
        -o-user-select: none;
        user-select: none;
        cursor:pointer;
    }
    .dropdown-menu .sub-menu {
        left: 100%;
        position: absolute;
        top: 0;
        display:none;
        margin-top: -1px;
        border-top-left-radius:0;
        border-bottom-left-radius:0;
        border-left-color:#fff;
        box-shadow:none;
    }
    .right-caret:after,.left-caret:after
    {	content:"";
        border-bottom: 5px solid transparent;
        border-top: 5px solid transparent;
        display: inline-block;
        height: 0;
        vertical-align: middle;
        width: 0;
        margin-left:5px;
    }
    .right-caret:after
    {	border-left: 5px solid #ffaf46;
    }
    .left-caret:after
    {	border-right: 5px solid #ffaf46;
    }
    
    #list_tbl_77 th.asc:after {
        display: inline;
        content: 'asc';
        color: white;
    }
    
    #list_tbl_77 th.desc:after {
        display: inline;
        content: 'desc';
        color: white;
    }

    #backtotop_btn_77 {
        display: inline-block;
        background-color: #E1A19D;
        width: 50px;
        height: 50px;
        text-align: center;
        border-radius: 4px;
        position: fixed;
        bottom: 60px;
        right: 10px;
        transition: background-color .2s, opacity .2s, visibility .2s;
        opacity: 0;
        visibility: hidden;
        z-index: 1000;
    }
    
    #backtotop_btn_77::after {
        content: "\f077";
        font-family: FontAwesome;
        font-weight: normal;
        font-style: normal;
        font-size: 2em;
        line-height: 50px;
        color: #fff;
    }
    
    #backtotop_btn_77:hover {
        cursor: pointer;
        background-color: #c51d3a;
    }
    
    #backtotop_btn_77:active {
        background-color: #555;
    }
    
    #backtotop_btn_77.show {
        opacity: 1;
        visibility: visible;
    }

    #button_claim_and_unclaim{
        padding: 2px 22px;
    }

    #button_sorter,#button_sorter3,#button_sorter2   {
        background-color: #424242;
        border:none;
        font-size: 17px;
        border-radius: 0px;
        padding: 5px;
    }

    #button_sorter:hover,#button_sorter3:hover,#button_sorter2:hover  {
        color: black;
        background-color: #d3324d;
    }

    #changer  {
        background-color: #f5f0f6;
        border:none;
    }

    #dashboard_header_77 {
        padding-left: 50px;
        padding-right: 50px;
        padding: 0 50px 0 50px;
        background-color: #636363;
        padding-top: 5px;
        text-align: center;
    }
    
    #delete_history{
        background-color : white;
        text-decoration: underline;
        color: black;
        border: none;
    }

    #delete_history:hover{
        background-color : white;
        text-decoration: underline;
        color: red;
        border: none;
    }

    #delete_history_div{
        float: right;
    }

    #dropdownMenuLink{
        background-color: #e7dfe4;
        color: black;
        margin-bottom: 5px;
        margin-left: 10px;
        padding-top: 1px;
        padding-bottom: 1px;
        font-family: Arial, Helvetica, sans-serif;
        font-style: normal;
    }
    
    #dropdownMenuLink:hover{
        background-color: #f5f0f6;
        color: black;
        margin-bottom: 5px;
        margin-left: 10px;
        padding-top: 1px;
        padding-bottom: 1px;
        font-family: Arial, Helvetica, sans-serif;
        font-style: normal;
    }

    #list_tbl_77 {
        border-collapse: separate;
        border-spacing: 0 5px;
        table-layout: auto;
        width: 100%;
        margin-bottom: 50px;
        overflow-wrap: break-word;
    }
    
    #list_tbl_77 td {
        border-width: 1px 0;
        border-color: black;
        border-style: solid;
        padding: 2px 10px;
        text-align: center;
        vertical-align: middle;
        overflow-wrap: break-word;
        border: 1px solid black;
        border-collapse: separate;
        border-spacing: 0px;
        border-width: 1px 0 1px 1px;


    }
    
    #list_tbl2_77 {
        border-collapse: separate;
        border-spacing: 0 5px;
        table-layout: auto;
        width: 99%;
    }
    
    #list_tbl2_77 td {
        border-width: 1px 0;
        border-color: black;
        border-style: solid;
        padding: 5px 15px;
        text-align: center;
        vertical-align: middle;
        overflow-wrap: break-word;
    }

    
    #list_tbl_77 tbody tr:nth-child(even) {
        background-color: #f5f0f6;
    }
    
    #list_tbl_77 tbody tr:nth-child(odd) {
        background-color: #f5f0f6;
    }
    
    #list_tbl_77 th {
        background-color: #c51d3a;
        color: #ffff;
        text-align: center;
        border: 1px solid black;
        border-collapse: separate;
        border-spacing: 0px;
        border-width: 1px 0 1px 1px;
    }
    
    #list_tbl2_77 tbody tr:nth-child(even) {
        background-color: #f5f0f6;
    }
    
    #list_tbl2_77 tbody tr:nth-child(odd) {
        background-color: #f5f0f6;
    }

    
    #list_tbl2_77 th {
        background-color: #c51d3a;
        color: #ffff;
        text-align: center;
    }

    #list_tbl_77 th.asc:after {
        display: inline;
        content: 'asc';
        color: white;
    }
    
    #list_tbl_77 th.desc:after {
        display: inline;
        content: 'desc';
        color: white;
    }
    
    #list_tbl2_77 th.asc:after {
        display: inline;
        content: 'asc';
        color: white;
    }
    
    #list_tbl2_77 th.desc:after {
        display: inline;
        content: 'desc';
        color: white;
    }

    #search_box_77 {
        width: 54%;
        border-radius: 30px;
        padding-right: 15px;
        margin: 0 0 10px 6px;
    }
    
    #search_btn_77 {
        border-radius: 10px;
        padding-left: 10px;
        padding-right: 10px;
        margin: 0 0 10px 5px;
    }
    
    #search_btn_77:hover {
        color: #c51d3a;
    }

    .table-wrapper{
        max-height: 500px;
        overflow-y: scroll;
    }

    /* SCREEN RESPONSIVENESS */
    @media screen and (max-width : 400px){
        #dropdownMenuLink{
            display: none;
        }
    }
</style>


<body>
    <!--NAVIGATION BAR-->
    <div class="container-fluid" id="dashboard_header_77">
        <a href="{% url 'registrar_dashboard' %}" data-toggle="tooltip" data-placement="right" title="Home"><i class="fa fa-home" aria-hidden="true" style="font-size:30px; margin: 0 0 10px 6px;"></i></a>

        
        <!--SEARCH BAR-->
        <input type="search" class="search" style="width:50%; padding-left: 15px;" id="search_box_77" placeholder="Search" onkeyup="searching1()" onsearch="OnSearch (this)">
        
        {% if sorter_type != "DELETED" %}
        <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="border-radius: 1px;">
            Sort by
        </a>
        <!--DROPODOWN TO FILTER OLD TO LATEST-->
        <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
            <a class="dropdown-item" href="/registrar_dashboard_organize_request_list/LATEST">LATEST</a>
            <a class="dropdown-item" href="/registrar_dashboard_organize_request_list/OLDEST">OLD</a>
            <li><a class="trigger right-caret dropdown-item">REQUEST</a>
                <ul class="dropdown-menu sub-menu">
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/All"> All</a></li>
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/Honorable">Honorable Dismissal</a></li>
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/Subject">Subject Description</a></li>
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/Certification">Certification</a></li>
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/Authentication">Authentication/Verification</a></li>
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/Diploma">Diploma</a></li>
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/Transcript">Transcript of Records</a></li>
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/CAV">CAV</a></li>
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/Others">Others</a></li>

                </ul>
            </li>
            <li><a class="trigger right-caret dropdown-item">ACCOUNT TYPE</a>
                <ul class="dropdown-menu sub-menu">
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/All">All</a></li>           
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/Student">Student</a></li>
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/Old">Old Student</a></li>
                  <li><a class="dropdown-item" href="/registrar_dashboard_organize_request_list/Alumni">Alumni</a></li>

                </ul>
            </li>
        
        </div>
        {% endif %}
    </div>

    <!--BACK TO TOP BUTTON-->
    <a id="backtotop_btn_77"></a>


    <!-- MAIN-->
    <!--TAB BAR-->
        {% include 'html_files/message.html'%}
        <div class = "col-12"  >
            {% if sorter_type == "DELETED" %}
            <h3 style="text-align:center;">List of Deleted Request Forms</h3>
            {% else %}
            <h3 style="text-align:center;">List of Request Forms</h3>
            {% endif %}
            <div id ="button_claim_and_unclaim" class="mt-3 col-12">
                {% if sorter_type == "ALL" %}
                    <button class="button pl-2 pr-2 " style =" background-color : #c51d3a" id ="button_sorter" >All</button>
                    <button class="button pl-2 pr-2 " id ="button_sorter2" >Claimed</button>
                    <button class="button pl-2 pr-2 " id ="button_sorter3">Unclaimed</button>
                    <div id="delete_history_div">
                        <a href="/registrar_dashboard_organize_request_list/DELETED" class = "btn" type = "button" id ="delete_history">Delete History></a>
                    </div>
                {% elif sorter_type == "CLAIMED" %}
                    <button class="button pl-2 pr-2 " id ="button_sorter" >All</button>
                    <button class="button pl-2 pr-2 " style =" background-color : #c51d3a" id ="button_sorter2" >Claimed</button>
                    <button class="button pl-2 pr-2 " id ="button_sorter3">Unclaimed</button>
                    <div id="delete_history_div">
                        <a href="/registrar_dashboard_organize_request_list/DELETED" class = "btn" type = "button" id ="delete_history">Delete History></a>
                    </div>
                {% elif sorter_type == "UNCLAIMED" %}
                    <button class="button pl-2 pr-2 " id ="button_sorter" >All</button>
                    <button class="button pl-2 pr-2 " id ="button_sorter2" >Claimed</button>
                    <button class="button pl-2 pr-2 " style =" background-color : #c51d3a" id ="button_sorter3">Unclaimed</button>
                    <div id="delete_history_div">
                        <a href="/registrar_dashboard_organize_request_list/DELETED" class = "btn" type = "button" id ="delete_history">Delete History></a>
                    </div>
                {% elif sorter_type == "DELETED" %}
                    <button class="button pl-2 pr-2 " id ="button_sorter" >BACK</button>
                    <button class="button pl-2 pr-2 " id ="button_sorter2" hidden>Claimed</button>
                    <button class="button pl-2 pr-2 " style =" background-color : #c51d3a" id ="button_sorter3" hidden>Unclaimed</button>
                {% else %}
                    <button class="button pl-2 pr-2 " style =" background-color : #c51d3a" id ="button_sorter" >All</button>
                    <button class="button pl-2 pr-2 " id ="button_sorter2" >Claimed</button>
                    <button class="button pl-2 pr-2 " id ="button_sorter3">Unclaimed</button>
                    <div id="delete_history_div">
                        <a href="/registrar_dashboard_organize_request_list/DELETED" class = "btn" type = "button" id ="delete_history">Delete History></a>
                    </div>
                {% endif %}
            </div>
            <!--TABLE-->
            <div id="request_table"  class="tab-content" >
                <div class="outer-wrapper">
                    <div class="table-wrapper">
                    <table class="table results table-hover table-sortable table-responsive-sm" id="list_tbl_77">
                        <thead>
                            <tr>
                                <th hidden>#</th>
                                <th class="sorting" title="Sort by Name">Student's Name</th>
                                <th class="sorting" title="Sort by Request">Request</th>
                                <th>Date and Time Requested</th>

                                {% if sorter_type != "DELETED" %}
                                <th class="sorting" title="Sort">Clearance</th>
                                <th class="sorting" title="Sort" >Form 137-A</th>
                                <th class="sorting" title="Sort" colspan="3">Official Receipt</th>
                                {% endif %}
                                <th>Account Type</th>
                                <th>Status</th>
                                {% if sorter_type == "DELETED" %}
                                <th>Date and time Removed</th>
                                {% else %}
                                <th colspan="2">Appointment</th>
                                <th> </th>
                                {% endif %}
                            
                            </tr>
                            {% if sorter_type == "DELETED" %}
                            <tr class="no_data">
                                <td colspan="6"><i class="fa fa-warning"></i> No Data</td>
                            </tr>
                            <tr class="warning no-result">
                                <td colspan="6"><i class="fa fa-warning"></i> No result</td>
                            </tr>

                            {% else %}
                            <tr class="no_data">
                                <td colspan="11"><i class="fa fa-warning"></i> No Data</td>
                            </tr>
                            <tr class="warning no-result">
                                <td colspan="11"><i class="fa fa-warning"></i> No result</td>
                            </tr>
                            {% endif %}
                        </thead>
                        <tbody>
                            {% for instance in data %}
                            
                                <tr>
                                    <td hidden onclick="window.location='display_reqform/{{ instance.id }}'">{{instance.id}}</td>
                                    <td onclick="window.location='display_reqform/{{ instance.id }}'">{{instance.name}}</td>
                                    <td onclick="window.location='display_reqform/{{ instance.id }}'">{{instance.request}}</td>
                                    <td onclick="window.location='display_reqform/{{ instance.id }}'">{{instance.time_requested}}</td>
                                    
                                    {% if sorter_type != "DELETED" %}
                                    <td>{{instance.clearance}}</td>
                                    <td>
                                        <form name="change_form137" id="change" action="request_form137_update/{{ instance.id }}" method=POST>
                                        {% csrf_token %}
                                            <select onchange="this.form.submit()" name="form137_select" id="changer"> 
                                                    <option value="">{{instance.form_137}}</option>
                                                    <option value="✔">✔</option>
                                                    <option value="❌">❌</option>
                                                </select>
                                        </form> 
                                    </td>
                                    <td>
                                        <form name="change_position" id="change" action="request_official_update/{{ instance.id }}" method=POST>
                                            {% csrf_token %}
                                            
                                            <select onchange="this.form.submit()" name="or_select" id="changer" > 
                                                <option value="{{instance.official_receipt}}">{{instance.official_receipt}}</option>
                                                <option id="or" value="✔">✔</option>
                                                <option value="❌">❌</option>
                                            </select>
                                            
                                            <td style="padding-left: 0%; border-right-width: 0; border-left-width: 0;">
                                                {% if instance.official_receipt == "✔" and instance.or_num is None %}
                                                <div class="form-group-row" id="course_input">
                                                    <input type=date id="or_date" name="or_date" oninput="enter_lterm()" onkeypress="isNumber(event)">
                                                </div>
                                                {% elif instance.official_receipt == "✔" and instance.or_num is not None %}
                                                <div class="form-group-row" id="course_input">
                                                    <input  type=date id="or_date" hidden name="or_date" value="{{instance.or_date}}" oninput="enter_lterm()" onkeypress="isNumber(event)">
                                                </div>
                                                {% endif %}
                                    
                                            </td>

                                            <td style="padding-left: 0%; border-right-width: 0; border-left-width: 0;">
                                                {% if instance.official_receipt == "✔" and instance.or_num is None %}

                                                <div class="form-group-row" id="course_input">
                                                    <input id="or_number" name="or_number" placeholder="O.R. No."   size="8" oninput="enter_lterm()" onkeypress="isNumber(event)">
                                                </div>
                                                {% elif instance.official_receipt == "✔" and instance.or_num is not None %}
                                                <div class="form-group-row" id="course_input">
                                                    <input id="or_number" hidden name="or_number" placeholder="O.R. No."  value="{{instance.or_num}}" size="8" oninput="enter_lterm()" onkeypress="isNumber(event)">
                                                </div>
                                                {% endif %}
                                    
                                            </td>

                                        </form> 
                                    </td>
                                    {% endif %}

                                    <td onclick="window.location='display_reqform/{{ instance.id }}'">{{instance.current_status}}</td>
                                     
                                    {% if sorter_type == "DELETED" %}
                                    <td>{{instance.claim}}</td>
                                    <td>{{instance.deleted_timestamp}}
                                    {% else %}
                                    <td>
                                        <form name="change_position" id="change" action="request_claim_update/{{ instance.id }}" method=POST>
                                            {% csrf_token %}
                                            {% if instance.appointment ==  'NONE' %}
                                                <select onchange="this.form.submit()" name="claim_select" id="changer" style="opacity:0.5;" disabled > 
                                                    <option value="" >{{instance.claim}}</option>
                                                    <option value="CLAIMED">CLAIMED</option>
                                                    <option value="UNCLAIMED">UNCLAIMED</option>
                                                </select>
                                                {% else %}
                                                {% if instance.claim ==  'UNCLAIMED' %}
                                                <select onchange="this.form.submit()" name="claim_select" id="changer"> 
                                                    <option value="" >{{instance.claim}}</option>
                                                    <option value="CLAIMED">CLAIMED</option>
                                                    <option value="UNCLAIMED">UNCLAIMED</option>
                                                </select>
                                                {% else %}
                                                {{instance.claim}}
                                                {% endif %}
                                            {% endif %}
                                            </form> 
                                    </td>  
                                    {% if instance.user_removed == "1" %}
                                    <td >{{instance.appointment}}</td>
                                    <td >The Applicant's Account<br> has been Deleted,<br> Unable to Appoint <br>Schedule of Claiming.</td>
                                    {% else %}
                                    <td >{{instance.appointment}}</td>
                                    {% if instance.appointment == "NONE" %}
                                    <td><a href="{% url 'request_appointment' instance.id %}"><button type="button" class="table-icon"><i class="fa fa-comments table-i" aria-hidden="true">Set</i></button></a>
                                    </td>
                                    {% else %}
                                    <td><a href="{% url 'request_appointment' instance.id %}"><button type="button" class="table-icon"><i class="fa fa-comments table-i" aria-hidden="true">Set New</i></button></a>
                                    </td>
                                    {% endif%}
                                    {% endif%}
                                    <td><a href="{% url 'delete_reqform' instance.id %}" class="btn btn-white border-light btn-xl btn-1"
                                        role="button" style="border-radius: 10px; height: 35px;" aria-pressed="true">Remove</a>
                                    </td>
                                    {% endif%}
                                </tr>
                            {% endfor %}    
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <p class="text-center text-bold" id="p6_77"></p>
    </div>
    </hr>

    <p class="text-center text-bold" id="p6_77"></p>
</body>


<footer>
    <div>
        <p>© Technological University of the Philippines-Cavite</p>
    </div>
</footer>


</html>


<script>
    //DROPDOWN WITHIN A DROPDOWN 
    $(function(){
        $(".dropdown-menu > li > a.trigger").on("click",function(e){
            var current=$(this).next();
            var grandparent=$(this).parent().parent();
            if($(this).hasClass('left-caret')||$(this).hasClass('right-caret'))
                $(this).toggleClass('right-caret left-caret');
            grandparent.find('.left-caret').not(this).toggleClass('right-caret left-caret');
            grandparent.find(".sub-menu:visible").not(current).hide();
            current.toggle();
            e.stopPropagation();
        });
        $(".dropdown-menu > li > a:not(.trigger)").on("click",function(){
            var root=$(this).closest('.dropdown');
            root.find('.left-caret').toggleClass('right-caret left-caret');
            root.find('.sub-menu:visible').hide();
        });
    });

    //SORTING
    function sortTableByColumn(table, column, asc = true) {
        const dirModifier = asc ? 1 : -1;
        const tBody = table.tBodies[0];
        const rows = Array.from(tBody.querySelectorAll("tr"));

        // Sort each row
        const sortedRows = rows.sort((a, b) => {
            const aColText = a.querySelector(`td:nth-child(${ column + 1 })`).textContent.trim();
            const bColText = b.querySelector(`td:nth-child(${ column + 1 })`).textContent.trim();

            return aColText > bColText ? (1 * dirModifier) : (-1 * dirModifier);
        });

        // Remove all existing TRs from the table
        while (tBody.firstChild) {
            tBody.removeChild(tBody.firstChild);
        }

        // Re-add the newly sorted rows
        tBody.append(...sortedRows);

        // Remember how the column is currently sorted
        table.querySelectorAll("th").forEach(th => th.classList.remove("th-sort-asc", "th-sort-desc"));
        table.querySelector(`th:nth-child(${ column + 1})`).classList.toggle("th-sort-asc", asc);
        table.querySelector(`th:nth-child(${ column + 1})`).classList.toggle("th-sort-desc", !asc);
    }

    document.querySelectorAll(".table-sortable .sorting").forEach(headerCell => {
        headerCell.addEventListener("click", () => {
            const tableElement = headerCell.parentElement.parentElement.parentElement;
            const headerIndex = Array.prototype.indexOf.call(headerCell.parentElement.children, headerCell);
            const currentIsAscending = headerCell.classList.contains("th-sort-asc");

            sortTableByColumn(tableElement, headerIndex, !currentIsAscending);
        });
    });


    //TAB BUTTON
    document.getElementById('button_sorter').onclick = function() {
        location.href = "/registrar_dashboard_organize_request_list/ALL"
    };

    document.getElementById('button_sorter2').onclick = function() {
        location.href = "/registrar_dashboard_organize_request_list/CLAIMED"
    };

    document.getElementById('button_sorter3').onclick = function() {
        location.href = "/registrar_dashboard_organize_request_list/UNCLAIMED"
    };

    //RETURN TO DASHBOARD JS
    function openrdb() {
        window.location.replace("{% url 'registrar_dashboard' %}");
    }


    //DISPLAY NO DATA IF TABLE IS EMPTY
    var dattable = document.getElementById("list_tbl_77");
    var rowcount = dattable.tBodies[0].rows.length;

    if (rowcount == '0') {
        $('.no_data').show();
        $('.no-result').hide();
    } else {
        $('.no_data').hide();
        $('.no-result').hide();
    }
    // no data by default
    var dattable2 = document.getElementById("list_tbl2_77");
    var rowcount2 = dattable2.tBodies[0].rows.length;

    if (rowcount2 == '0') {
        $('.no_data2').show();
        $('.no-result2').hide();
    } else {
        $('.no_data2').hide();
        $('.no-result2').hide();
    }

    
   
    // TAB JS
    var items = document.querySelectorAll('#tabz_77');
    for (var i = 0, len = items.length; i < len; i++) {
        (function() {
                var t, e = this,
                    a = "[data-tab]",
                    n = document.body,
                    r = n.matchesSelector || n.webkitMatchesSelector || n.mozMatchesSelector || n.msMatchesSelector,
                    o = function() {
                        var a = e.querySelectorAll("[data-tab-content]") || [];
                        for (t = 0; t < a.length; t++) a[t].style.display = "none"
                    },
                    i = function(n) {
                        var r = e.querySelectorAll(a) || [];
                        for (t = 0; t < r.length; t++) {
                            var i = r[t],
                                s = i.className.replace("tab-active", "").trim();
                            i.className = s
                        }
                        o(), n.className += " tab-active";
                        var l = n.getAttribute("href"),
                            c = e.querySelector(l);
                        c && (c.style.display = "")
                    },
                    s = e.querySelector(".tab-active" + a);
                s = s || e.querySelector(a), s && i(s), e.addEventListener("click", function(t) {
                    var e = t.target;
                    r.call(e, a) && i(e)
                })
            }
            .bind(items[i]))();
    }

    // TO APPROVE STUDENT
    function deleteRow(r) {
        var i = r.parentNode.parentNode.rowIndex;
        document.getElementById("list_tbl_77").deleteRow(i);
        swal({
            title: "Done",
            text: "Application Approved!",
            icon: "success",
            button: "Ok",
        })
    }

    // ONLY NUMBERS IN INPUT BOX JS
     function isNumber(evt) {
        if (event.key.length === 1 && /\D/.test(event.key)) {
            event.preventDefault();
        }
    }
    $.fn.digits = function() {
        return this.each(function() {
            $(this).text($(this).text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,"));
        })
    }
    $("span.numbers").digits();


    //MULTIPLE SPACE REMOVER
    $(function() {
        var txt1 = $("#search_box_77");
        var func = function() {
            txt1.val(txt1.val().replace(/\s\s+/g, ' '));
        }
        txt1.keyup(func).blur(func);
    });

    // DISALLOW FIRST SPACES IN INPUT BOX JS
    $(function() {
        $('body').on('keydown', '#search_box_77', function(e) {
            if (e.which === 32 && e.target.selectionStart === 0) {
                return false;
            }
        });
    });

    // SEARCH REQUEST LIST
    function searching1() {
        $(document).ready(function() {
            $(".search").keyup(function() {
                var searchTerm = $(".search").val();
                var listItem = $('.results tbody').children('tr');
                var searchSplit = searchTerm.replace(/ /g, "'):containsi('")

                $.extend($.expr[':'], {
                    'containsi': function(elem, i, match, array) {
                        return (elem.textContent || elem.innerText || '').toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
                    }
                });

                $(".results tbody tr").not(":containsi('" + searchSplit + "')").each(function(e) {
                    $(this).attr('visible', 'false');
                });

                $(".results tbody tr:containsi('" + searchSplit + "')").each(function(e) {
                    $(this).attr('visible', 'true');
                });

                var jobCount = $('.results tbody tr[visible="true"]').length;
                $('.counter').text(jobCount + ' item');

                if (jobCount == '0') {
                    $('.no-result').show();
                    $('.no_data').hide();
                } else {
                    $('.no-result').hide();
                }
            });
        });

        $(document).ready(function() {
            $(".search").keyup(function() {
                var searchTerm = $(".search").val();
                var listItem = $('.results2 tbody').children('tr');
                var searchSplit = searchTerm.replace(/ /g, "'):containsi('")

                $.extend($.expr[':'], {
                    'containsi': function(elem, i, match, array) {
                        return (elem.textContent || elem.innerText || '').toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
                    }
                });

                $(".results2 tbody tr").not(":containsi('" + searchSplit + "')").each(function(e) {
                    $(this).attr('visible', 'false');
                });

                $(".results2 tbody tr:containsi('" + searchSplit + "')").each(function(e) {
                    $(this).attr('visible', 'true');
                });

                var DocCount = $('.results2 tbody tr[visible="true"]').length;
                $('.counter').text(DocCount + ' item');

                if (DocCount == '0') {
                    $('.no-result2').show();
                    $('.no_data2').hide();
                } else {
                    $('.no-result2').hide();
                }
            });
        });
    }



    // BACK TO TOP FUNCTION
    var btn = $("#backtotop_btn_77");

    $(window).scroll(function() {
        if ($(window).scrollTop() > 300) {
            btn.addClass("show");
        } else {
            btn.removeClass("show");
        }
    });

    btn.on("click", function(e) {
        e.preventDefault();
        $("html, body").animate({
            scrollTop: 0
        }, "300");
    });

  

    // REFRESH TABLE WHEN SEARCH X BUTTON PRESSED
    function OnSearch(input) {
        location.reload();
    }

    // PREVENT SCROLLING WHILE SWITCHING TABS
    $('#tabz_77 a').click(function(e) {
        e.preventDefault();
        $(this).tab('show');

        var checked = $(this).find('input').prop('checked');
        $(this).find('input').prop('checked', !checked);
    });

    // RESET SEARCH BAR WHEN BACK BUTTON PRESSED
    $(window).bind("pageshow", function() {

        document.getElementById("search_box_77").value = "";
    });

    
</script>

