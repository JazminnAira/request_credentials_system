<!--
BET-COET 2021-2023
Programmers:
        Trisha Eunis Elicot
        Dana Grace Fulla
        Allora Blesse Lagura
        Jazminn Aira Terencio
Adviser:
        Mr.Jay Victor Gumboc
-->


<!DOCTYPE html>
{% load static %}
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="icon" href="{% static 'Media/tup_logo.png' %}">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/signature_pad/1.3.5/signature_pad.min.js" integrity="sha512-kw/nRM/BMR2XGArXnOoxKOO5VBHLdITAW00aG8qK4zBzcLVZ4nzg7/oYCaoiwc8U9zrnsO9UHqpyljJ8+iqYiQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <title>Clearance Form List</title>

    <script type="text/javascript">
        function preventBack() {
            window.history.forward();
        }
        setTimeout("preventBack()", 0);
        window.onunload = function() {
            null
        };
    </script>
</head>


<!-- ALL CSS ARE CATEGORIZED ACCORDING TO IDs, CLASSES, MEDIA QUERIES AND SORTED ALPHABETICALLY  -->
<style>
    a {
        font-style: italic;
        color: #000;
    }

    a :hover {
        color: #fff;
    }

    button {
        border-radius: 10px;
        background-color: #c51d3a;
        color: white;
    }
    
    button.list_tbl {
        background-color: #c51d3a;
    }

    canvas #signature-pad {
        background: #fff;
        width: 100%;
        height: 100%;
        cursor: crosshair;
    }

    footer {
        position: fixed;
        bottom: 0;
        width: 100%;
        text-align: center;
        height: 40 px;
        background: #424242;
        color: white;
        padding-top: 10px;
    }
    
    i {
        padding-left: 10px;
    }
    
    hr {
        border-top: 2px solid black;
    }
    
    h1 {
        padding-left: 15px;
        font-weight: bolder;
    }

    html {
        font-size: 1rem;
    }

    p1 {
        font-size: 30px;
    }
    
    p2 {
        font-size: 20px;
        font-weight: bolder;
    }

    table{
        min-width: max-content;
        
    }

    thead{
         position: sticky;
         top: 0px;
    }

    thead,td{
         padding: 10px;
    }

    tr:hover td {
        background-color: #636363;
        color: #fff;
    }

    .btn_save{
        background-color: #0f0d0d;
        color: white;
        border-color: white;
    }

    .btn_save:hover{
        background-color: #3b3b3b;
        color: #c9c9c9;
        border-color: whi;
    }

    .counter {
        padding: 8px;
        color: #ccc;
    }

    .closebtn:hover{
        background-color : #d3324d;;
        color: black;
    }

    .highlight {
        background-color:transparent;
        animation: highlightRow 2s ease-in-out;
    }

    .modal-body {
        background: #e0e0e0;
        box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.125);
        padding: 40px;
    }

    .outer-wrapper{
        margin: 20px;
        border-radius: 5px;
    }

    .results tr[visible='false'],
    .no-result {
        display: none;
    }
    
    .results tr[visible='true'] {
        display: table-row;
    }

    .signature_section{
        height: 94vh;
        width: 0;
        position: fixed;
        z-index: 1;
        top: 0;
        right: 0;
        background-color: white;
        overflow-x: hidden;
        transition: 0.5s;
        padding-top: 60px;
    }

    .tab {
        text-decoration: none;
        color: inherit;
        padding: 7px 14px;
        transition: opacity 0.3s;
        display: inline-block;
        border-radius: 3px;
        margin-right: 10px;
        margin-left: 20px;
    }
    
    .tab:hover {
        color: #c51d3a;
    }
    
    .tab-content {
        padding: 6px 12px;
        min-height: 100px;
        animation: fadeEffect 1s;
        padding-bottom: 50px;
    }

    .table-icon {
        background-color: #dedede;
        color: #000;
        align-content: center;
    }

    .table-i{
        padding: 0%;
    }

    .table_list {
        transition: margin-right .5s;
        padding: 1px;
    }

    .table-sortable th {
        cursor: pointer;
        table-layout: fixed;
    }
    
    .table-sortable .th-sort-asc::after {
        display: inline;
        content: "\25b4";
        color: white;
    }
    
    .table-sortable .th-sort-desc::after {
        display: inline;
        content: "\25be";
        color: white;
    }   
    
    .table-sortable .th-sort-asc,
    .table-sortable .th-sort-desc {
        background: rgba(0, 0, 0, 0.1);
    }

    .table-wrapper{
        max-height: 600px;
        overflow-y: scroll;
    }

    .sorting::after{
        display: inline;
        font-family:FontAwesome;
        content:"\f0dc";
        color: white;
        font-size: 12px;
        margin-left:3px;
    }
    
    #approve_sig_btn, #cancel_edit_digtal{
        background-color: #dedede;
        color: black;
    }

    #approve_sig_btn:hover, #cancel_edit_digtal:hover{
        background-color: #dedede;
        color: white;
    }

    #backtotop_btn_52 {
        display: inline-block;
        background-color: #E1A19D;
        width: 50px;
        height: 50px;
        text-align: center;
        border-radius: 4px;
        position: fixed;
        bottom: 60px;
        right: 10px;
        transition: background-color .2s, opacity .2s, visibility .2s;
        opacity: 0;
        visibility: hidden;
        z-index: 1000;
    }

    #backtotop_btn_52::after {
        content: "\f077";
        font-family: FontAwesome;
        font-weight: normal;
        font-style: normal;
        font-size: 2em;
        line-height: 50px;
        color: #fff;
    }
    
    #backtotop_btn_52:hover {
        cursor: pointer;
        background-color: #c51d3a;
    }
    
    #backtotop_btn_52:active {
        background-color: #555;
    }
    
    #backtotop_btn_52.show {
        opacity: 1;
        visibility: visible;
    }

    #btn,
    #open_signature,
    #approve_sig_btn {
        border-radius: 10px;
        background-color: #c51d3a;
        color: #fff;
    }
    
    #btn:hover,
    #open_signature:hover,
    #approve_sig_btn:hover {
        border-radius: 10px;
        background-color: #c51d3a;
        color: black;
    }

    #cancel_create:hover , #cancel_upload:hover{
        background-color : #d3324d;;
        color: black;
    }

    #dashboard_header_52 {
        padding-left: 50px;
        padding-right: 50px;
        padding: 0 50px 0 50px;
        background-color: #636363;
        padding-top: 5px;
        text-align: center;
        position: sticky;
        top: 0px;
        z-index: 2;
    }

    #esign_attach_sig_btn, #create_new_esign{
        background-color : #c51d3a;
        color : white;
    }

    #esign_attach_sig_btn:hover, #create_new_esign:hover{
        background-color : #d3324d;;
        color: black;
    }
    
    #list_tbl_52 {
        border-spacing: 0 5px;
        width: 100%;
        margin-bottom: 50px;
        table-layout: auto; /* TO MAKE ROW FIT*/
        border-collapse: separate;
        margin-top: 20px;
    }

    #list_tbl_52 .absorbing-column {
        width: 100%;
        }
    
    #list_tbl_52 th.asc:after {
        display: inline;
        content: 'asc';
        color: white;
    }
    
    #list_tbl_52 th.desc:after {
        display: inline;
        content: 'desc';
        color: white;
    }
    
    #list_tbl2_52 th.asc:after {
        display: inline;
        content: 'asc';
        color: white;
    }
    
    #list_tbl2_52 th.desc:after {
        display: inline;
        content: 'desc';
        color: white;
    }
    
    #list_tbl_52 td {
        border-width: 1px 0;
        border-color: black;
        border-style: solid;
        padding: 2px 10px;
        text-align: center;
        vertical-align: middle;
        overflow-wrap: break-word;
    }
    
    #list_tbl2_52 {
        border-collapse: separate;
        border-spacing: 0 5px;
        table-layout: fixed;
        width: 99%;
    }
    
    #list_tbl2_52 td {
        border-width: 2px 0;
    }

    #list_tbl_52 tbody tr:nth-child(even) {
        background-color: #dedede;
    }
    
    #list_tbl_52 tbody tr:nth-child(odd) {
        background-color: #f5f0f6;
    }
    
    #list_tbl_52 th {
        background-color: #c51d3a;
        color: #ffff;
        text-align: center;
    }
    
    #list_tbl2_52 tbody tr:nth-child(even) {
        background-color: #dedede;
    }
    
    #list_tbl2_52 tbody tr:nth-child(odd) {
        background-color: #f5f0f6;
    }
    
    #list_tbl2_52 th {
        background-color: #c51d3a;
        color: #ffff;
        text-align: center;
    }
    
    #open_signature:hover{
        background-color : #d3324d;;
        color: black;
    }
    
    #search_box_52 {
        width: 54%;
        border-radius: 30px;
        padding-left: 15px;
        padding-right: 15px;
        margin: 0 0 10px 6px;
    }
    
    #search_btn_52 {
        border-radius: 10px;
        padding-left: 10px;
        padding-right: 10px;
        margin: 0 0 10px 5px;
    }
    
    #search_btn_52:hover {
        color: #c51d3a;
    }

    #table_main{
        padding: 6px 15px;
        min-height: 100px;
        animation: fadeEffect 1s;
        padding-bottom: 50px;
    }

    #upload_attach_sig_btn{
        background-color: #0f0d0d;
        color: white;
        border-color: white;
    }

    #upload_attach_sig_btn:hover{
        background-color: #3b3b3b;
        color: #c9c9c9;
        border-color: black;
    }

    @include media-breakpoint-up(sm) {
        html {
            font-size: 1.2rem;
        }
    }
  
    @include media-breakpoint-up(md) {
        html {
            6font-size: 1.4rem;
        }
    }
  
    @include media-breakpoint-up(lg) {
        html {
            font-size: 1.6rem;
        }
    }

    @keyframes highlightRow {
        0%  { background-color: red; }
        100% { background-color: transparent; }
    }

    /* SCREEN RESPONSIVENESS */
    @media screen and (max-width: 500px) {
        .signature_section {
            padding-top: 15px;
        }

        #footer_bottom{
            display: none;
        }

        #footer_div{
            width: 18em;
            align: right;
            display: none;
        }
    }


    /* ----------Revisions----------------- */
    #myDIV {
    width: 100%;
    padding: 50px 0;
    text-align: left;
    background-color: lightblue;
    height: 350px;
    
    }

    * {
    box-sizing: border-box;
    }

    /* Create three equal columns that floats next to each other */
    .column {
    float: left;
    width: 20%;
    padding: 10px;
    
    }

    /* Clear floats after the columns */
    .row:after {
    content: "";
    display: table;
    clear: both;
    }
</style>

<body>
    
    <!--NAVIGATION BAR-->
    <div class="container-fluid" id="dashboard_header_52">
        <a href="{% url 'faculty_dashboard' %}" data-toggle="tooltip" data-placement="right" title="Home" style="font-size:30px;"><i class="fa fa-home">
            </i> </a>

        <!--SEARCH BAR-->
        <input type="search" class="search" style="width:50%; padding-left: 15px;" id="search_box_52" name="search_box_052" placeholder="Search" onkeyup="searching1(), searching2()" onsearch="OnSearch (this)">

    </div>
    <div class="div">{% include 'html_files/message.html'%}</div>
    <!--BACK TO TOP BUTTON-->
    <a id="backtotop_btn_52"></a>

    
    <!--APPOINTMENT MODAL-->
   
    <div class="modal fade" id="appointmentmodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-confirm">
            <div class="modal-content">
                <div class="container p-sm-3 mt-4 container-1" style="background-color: #fff; float: center;
                    border-radius: 10px; width: 800px; height: max-content;" >
                    <div class="modal-header modal-1"  style="width: 100%;">
                            <h3 class="modal-title w-100 text-center">Set an Appointment
                            </h3>
                
                            <!--MODAL CLOSE BUTTON-->
                            <button type="button" class="close_btn" data-placement="right" title="Close" 
                            onclick="window.location.assign('/faculty_dashboard_clearance_list/0')">X</button>
                    </div>
                    <form method="POST" action="appointment" style="height:100%;" >
                        {% csrf_token %}
                        <input type="text" hidden value="{id}"> 
                        <div class="modal-body ">
                            <input type="hidden" name="usertype_001" id="usertype" value="">
                            
                            <!--DATE OF APPOINTMENT-->
                            <div class="form-group">
                                <label for="idnum">ID Number:</label>
                                <input type="text" id="date" name="date_appointment" class="form-control input-field" 
                                style="height: 50px; margin-bottom: 20px;" >
                                <p id="sid_error_01"></p>
                            </div>
            
                            <!--TIME OF APPOINTMENT-->
                            <div class="form-group" id="course_input">
                                <label for="course">Course:</label>
                                <input type="text" id="time" name="time_appointment" class="form-control input-field" 
                                style="height: 50px; margin-bottom: 20px;" >
                                <p id="sc_error_01"></p>
                            </div>
                            
                            <!--ADDITIONAL MESSAGE-->
                            <div class="form-group">
                                <label for="cnum">Additional Message: (Optional)</label>
                                <input type="text" id="additionalmessage" name="additionalmessage" class="form-control input-field" 
                                style="height: 50px; margin-bottom: 20px;" >
                                <p id="scn_error_01"></p>
                            </div>
                        </div>
                        <!--MODAL FOOTER-->
                        <div class="modal-footer">
            
                            <!--SIGNUP BUTTON-->
                            <button type="submit" class="btn btn-2 btn-lg" name="Ssubmit_btn_001" 
                            id="Ssubmit_btn_01" >Send</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <!--MAIN--> 
    <h3 style="text-align:center; margin-top: 10px;" id="h3_title">List of Clearance Forms</h3>
    <div class="border pt-2 signature_section" id ="signature_section">
        <div align="right"><button type ="button" class="closebtn bg-danger btn-lg text-white" id ="close_signature" >X</button></div>
        <div class = "p-4" id="show_details">
            <div class="bg-dark p-2"><h3 class = "text-white">APPROVE USING:</h3></div>
        </div>
        
        <input type="text" id="attach_signature_to" hidden>
        <input type = "text" id="department" hidden>
        <input type ="text" id = "esign_checker" value="{{esign_check}}" hidden>
        <input type = "text" id = "upload_checker" value = "{{uploadsig_check}}" hidden>
        
        <!--CHOOSING APPROVAL SIGNATURE-->
        <div class= "mx-auto" align="center" id="button_area">
            <br>
            <!--ATTACH ESIGN BUTTON-->
            <div class="btn-group col-sm-10 col-md-10 col-xl-10">
                <button type = "button" id = "esign_attach_sig_btn" class ="btn btn-lg border p-3 border-dark">DIGITAL SIGNATURE</button>
                <button type ="button" id="edit_esign_btn" class="btn btn-lg border-dark bg-secondary col-3 p-3 text-white center-block" title="Edit Digital Signature"><i class= "fa fa-edit" style ="font-size:25px;"></i></button><br>
            </div>
            <br>
            <br>
            <!--APPROVE ONLY-->
            <div class="btn-group col-sm-10 col-md-10 col-xl-10">
                <button type = "button" id = "approve_sig_btn" class ="btn btn-lg p-3 bg-dark border text-white border-dark">PHYSICAL SIGNATURE</button><br>
            </div>
            
            <br><br><br><br><br>
            <!-- NOTE ON ATTACHING SIGNATURES-->
            <div style="border:1px solid #000; margin:0 5 0 5" class="container">
            <p class="text-align:justify;">
                
                <center><b>NOTE:</b></center>
                <br>
                If you intend to digitally sign the following form/s, please read this carefully before signing:
                <br><br>
                By signing your name electronically on the form/s, you are agreeing that your
                electronic signature is the legal equivalent of your handwritten signature and consenting
                the system to use it to signify that you approve the form/s.
                <br><br>
                Rest assured that your signature will be securely stored and will not be used without your authorization.
            </p>
            </div>
        </div>
        
        <div id="create_signature_area" class="p-1" hidden>
            <div id = "esignature_display" class = "m-2 mt-2 p-1" align="center">
                <div class = "bg-dark p-2" align="left"><h4 class = "text-white">CURRENT E-SIGNATURE:</h4></div>
            {% if esign_check %}
                <img src ="/Media/{{e_signature}}" id ="imgSaved" class="p-1 mt-2 w-75 border border-dark rounded" >
                <label class="lead">Recorded in: <b>{{esignature_datetime}}</b></label>
            {% elif uploadsig_check %}
                <img src ="/Media/{{uploaded_signature}}" id ="imgSaved" class="p-1 mt-3 w-75 border border-dark rounded" >
                <label class="lead">Recorded in: <b>{{uploaded_datetime}}</b></label>
            {%else%}
                <div clas="p-2 border rounded">NO CURRENT E-SIGNATURE</div>
            {% endif %}
            </div>
            <hr>

            <!--CREATE NEW E-SIGNATURE-->
            <div id="create_new_button" align="center" hidden>
                <button type = "button" class = "btn btn-lg border-dark p-3 text-lg" id = "create_new_esign" style="width: 300px;">Create New E-signature</button>
                <br>
                <br>
            </div>
            
            <div id="create_new_esignature" hidden>
                <div class = "bg-dark p-2 mt-2"><h4 id = "new_signature_text" class = "text-white">CREATE SIGNATURE HERE:</h4></div>
                <div class="wrapper border rounded m-2 mt-3 p-1" align = "center">
                    <canvas name="signature" id="signature_pad" width="350" height="180" class="m-1"></canvas>
                    <button type="button" id="clear" class = "btn-dark text-white col-3 p-1 m-1 btn-lg"><span> Clear </span></button> 
                    <button type="button" id="cancel_create" class = "col-3 p-1 m-1 btn-lg"><span> Cancel </span></button> 
                </div>
            </div>

            <!--UPLOAD NEW E-SIGNATURE-->
            <div id="upload_new_button" align="center" hidden>
                <button type = "button" class = "btn btn-lg border-dark bg-dark text-white p-3 text-lg " id = "upload_new_esign" style="width: 300px;">Attach New Image of Signature</button>
                <br>
                <br>
                <button type = "button" class = "btn btn-lg border-dark p-2 text-lg" id = "cancel_edit_digtal" style="width: 300px;">Cancel</button>
            </div>

            <form method="POST" action ="update_clearance_signature/{{id}}" enctype="multipart/form-data">
                {% csrf_token %}
                <textarea id ="image_encoded" name="image_encoded" hidden></textarea>
                <input type="text" name ="id_num" value ="{{id}}" hidden>
                <div id ="upload_signature_area" class="p-2" hidden>
                    <div class = "bg-dark p-2 mb-2 mt-1"><h4 class = "text-white" id ="upload_text">UPLOAD SIGNATURE HERE:</h4></div>
                    <img id="preview" class="p-1 w-100 border">
                    <input id="uploaded_signature_new" type="file" accept="image/*" name= "new_upload_signature" onchange="loadFile(event)">
                    <p><label>Note: Please attach an image of your signature with clear and clean white background. Submit it with this file name format: (LASTNAME_FIRSTNAME_MIDDLENAME.jpg/png)<br> See example: <img src="static/Media/sample.png"></label></p>
                    <button type="button" id="cancel_upload" class = "col-3 p-1 m-1 btn-lg"><span> Cancel </span></button> 
                </div>
                <div id="submit_signature" class="m-3" align="center" hidden>
                    <button type="submit" class="btn col-8 btn-lg border border-dark btn_save">Save Signature</button>
                </div>
            </form>
        </div>
    </div>

    <div class ="table_list" id = "table_list">
        <form method="POST" action="faculty_dashboard_clearance_list" id="table_main">
            {% csrf_token %}
            <div class="outer-wrapper">
                <div class="table-wrapper">
            <table class="table results table-hover table-sortable table-responsive-sm" id="list_tbl_52">
                <thead style="height: 70px;">
                    <tr>
                        {% if st %}
                        <th><input type="checkbox" class="check" onchange="checkAll(this)" name="chk[]" id="all_check" />&nbsp;All</th>
                        {% else%}
                        <th><input type="checkbox" onchange="checkAll(this)" name="chk[]" id="all_check" disabled/>&nbsp;All</th>
                        {% endif %}
                        <th hidden> # </th>
                        <th class="sorting" title="Sort by Name">Student's Name</th>
                        <th class="sorting" title="Sort by Course">Course</th>
                        <th class="sorting" title="Sort by ID Number">ID Number</th>
                        <th class="sorting" title="Sort by Requested Credentials">Purpose of Request</th>
                        <th>Appointment</th>
                        <th id="department_th"></th>
                        <th id="course_adviser_th"></th>
                        
                    </tr>

                    <tr class="no_data">
                        <td colspan="10"><i class="fa fa-warning"></i> No Data</td>
                    </tr>

                    <tr class="warning no-result">
                        <td colspan="10"><i class="fa fa-warning"></i> No result</td>
                    </tr>
                </thead>
                <input type ="text" value="{{preview_id}}" id="id_determiner" hidden>
                
                
                <tbody>
                {% for instance in st %}

                    <tr id="Add">    
                    <!--DETERMINING DEPARTMENT HEAD-->
                        
                        <td><input type="checkbox" id="boxes" name="boxes" class="check" value={{instance.id}}></td>    
                        <td class="nr" hidden onclick="window.location='{{ instance.id }}'">{{instance.id}}</td>
                        <td class="name" onclick="window.location='{{ instance.id }}'">{{instance.name}}</td> 
                        <td onclick="window.location='{{ instance.id }}'">{{instance.course}}</td>
                        <td onclick="window.location='{{ instance.id }}'">{{instance.student_id}}</td>
                        <td class="request" onclick="window.location='{{ instance.id }}'">{{instance.purpose_of_request}}</td>
                        <td><a href="appointment/{{ instance.id }}/clearance"><button type="button" class="table-icon"><i class="fa fa-comments table-i" aria-hidden="true"></i>  Message</button></a></td>   
                        
                        {% if dep == "HOCS" %}
                            <script>document.querySelector('#department_th').innerText = "OCS";</script>
                            {% if instance.accountant_signature == "UNAPPROVED" %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department1(this)">Approve</button></td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'" >APPROVED</td>
                            {% endif %}
                        {% elif dep == "HDLA" %}
                            <script>document.querySelector('#department_th').innerText = "DLA";</script>
                            {% if instance.liberal_arts_signature == "UNAPPROVED" %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department12(this)">Approve</button></td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'">APPROVED</td>
                            {% endif %}
                        {% elif dep == "HDMS" %}
                            <script>document.querySelector('#department_th').innerText = "DMS";</script>
                            {% if instance.mathsci_dept_signature == "UNAPPROVED" %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department2(this)">Approve</button></td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'">APPROVED</td>
                            {% endif %}
                        {% elif dep == "HDPECS" %}
                            <script>document.querySelector('#department_th').innerText = "DPECS";</script>
                            {% if instance.pe_dept_signature == "UNAPPROVED" %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department3(this)">Approve</button></td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'">APPROVED</td>
                            {% endif %}
                        {% elif dep == "HDED" %}
                            <script>document.querySelector('#department_th').innerText = "DED";</script>
                            {% if instance.ieduc_dept_signature == "UNAPPROVED" %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department4(this)">Approve</button></td>
                            {% elif instance.ieduc_dept_signature == "_APPROVED" %}
                            <td onclick="window.location='{{ instance.id }}'">❌</td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'">APPROVED</td>
                            {% endif %}
                        {% elif dep == "HDIT" %} 
                            <script>document.querySelector('#department_th').innerText = "DIT";</script>
                            {% if instance.it_dept_signature == "UNAPPROVED" %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department5(this)">Approve</button></td>
                            {% elif instance.it_dept_signature == "_APPROVED" %}
                            <td onclick="window.location='{{ instance.id }}'">❌</td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'">APPROVED</td>
                            {% endif %}
                        {% elif dep == "HDOE" %}
                            <script>document.querySelector('#department_th').innerText = "DOE";</script>
                            {% if instance.eng_dept_signature == "UNAPPROVED" %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department6(this)">Approve</button></td>
                            {% elif instance.eng_dept_signature == "_APPROVED" %}
                            <td onclick="window.location='{{ instance.id }}'">❌</td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'">APPROVED</td>
                            {% endif %}
                        {% elif dep == "HOCL" %}
                            <script>document.querySelector('#department_th').innerText = "OCL";</script>
                            {% if instance.library_signature == "UNAPPROVED" %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department7(this)">Approve</button></td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'">APPROVED</td>
                            {% endif %}
                        {% elif dep == "HOGS" %}
                            <script>document.querySelector('#department_th').innerText = "OGS";</script>
                            {% if instance.guidance_office_signature == "UNAPPROVED" %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department8(this)">Approve</button></td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'">APPROVED</td>
                            {% endif %}
                        {% elif dep == "HOSA" %}
                            <script>document.querySelector('#department_th').innerText = "OSA";</script>
                            {% if instance.osa_signature == "UNAPPROVED" %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department9(this)">Approve</button></td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'">APPROVED</td>
                            {% endif %}
                        {% elif dep == "HADAA" %}
                            <script>document.querySelector('#department_th').innerText = "ADAA";</script>
                            {% if instance.academic_affairs_signature == "UNAPPROVED" %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department10(this)">Approve</button></td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'">APPROVED</td>
                            {% endif %}
                        {% else %}
                            <td></td>   
                        {% endif %}
                        {% if course_adv %} 
                            <script>document.querySelector('#course_adviser_th').innerText = "Course/Shop Adviser";</script>
                            {% if instance.course_adviser_signature == f_n_unapproved %}
                            <td><button type ="button" class="button user_id apprv" id="open_signature" onclick = "OpenSignature(this), department11(this)">Approve</button></td>
                            {% elif instance.course_adviser_signature != f_n_unapproved and instance.course_adviser != request.user.full_name %}
                            <td onclick="window.location='{{ instance.id }}'">❌</td>
                            {% else %}
                            <td onclick="window.location='{{ instance.id }}'">APPROVED</td>
                            {% endif %}
                        {% else %}
                            <td></td>
                        {% endif %}
                          
                    </tr>
                {% endfor %}    
                </tbody>
                
            </table>
            </div>
           
        </form>
        <!--APPROVE ALL-->
        <form method="POST" action="faculty_dashboard_clearance_list_all" hidden >
            {% csrf_token %}
            <input type="text" id="id_list" name="id_list" />
            <input type="text" id="sig" name="sig" />
            
            <button type="submit" id="submit_btn_all" hidden />
        </form>
        <button type ="button" disabled="disabled" name="approve_all" class="button btn-m user_id approve_all" id="open_signature" onclick = "OpenSignature(this)">Approve All</button>
        {% for s in preview_data %}
        <div id="myDIV"  class = "border bg-white border-dark p-3 m-1" hidden>
               <div class="row">
                   <div class="column">
                   
                   <tr>
                       <td ><b>Name:</b> </td><br>
                       <td >{{s.name}}</td>
                   </tr><br>
           
                   <tr>
                       <td><b>Date Filed:</b><br>
                       <td>{{s.date_filed}}</td>
                   </tr><br>
           
                   <tr>
                       
                       <td><b>Present Address:</b> </td><br>
                       <td>{{s.present_address}}</td>
                       
                   </tr><br>
               
                   <tr>
                       
                       <td><b>Date Admitted in TUPC:</b><br>
                       <td>{{s.date_admitted_in_tup}}</td>
                       
                   </tr><br>

                   <tr>
                       
                       <td><b>Course:</b> </td><br>
                       <td>{{s.course}}</td>
                       
                   </tr><br>
                  
                   
               </div>
               <div class="column">

                   <tr>
                       
                       <td><b>Highschool Graduated:</b><br>
                       <td>{{s.highschool_graduated}}</td>
                       
                   </tr><br>

                   <tr>
                       <td><b>Did You Graduate at TUPC:</b><br>

                       <td>{% if s.tupc_graduate == "YES" %}
                       <label class="radio-inline">
                       <input class="my-1 mr-2" type="radio" name="grad_option_420" disabled id="gradYes_radio_42" value="YES" onclick="EnableDisableTextBox()" oninput="enter_tupgradYes()" checked disabled>Yes
                       </label>
                       <label class="radio-inline">
                       <input class="my-1 mr-2" type="radio" name="grad_option_420" disabled id="gradNo_radio_42" value="NO" onclick="EnableDisableTextBox()" oninput ="enter_tupgradNo()" disabled>No
                       </label>
                       {% else %}
                       <label class="radio-inline">
                       <input class="my-1 mr-2" type="radio" name="grad_option_420" disabled id="gradYes_radio_42" value="YES" onclick="EnableDisableTextBox()" oninput="enter_tupgradYes()" disabled>Yes
                       </label>
                       <label class="radio-inline">
                       <input class="my-1 mr-2" type="radio" name="grad_option_420" disabled id="gradNo_radio_42" value="NO" onclick="EnableDisableTextBox()" oninput ="enter_tupgradNo()"checked disabled>No
                       </label>
                       {% endif %}</td>
                       
                   </tr><br>

                   <tr>
                       
                       <td><b>If Yes indicate the date:</b><br>
                       <td>{{s.year_graduated_in_tupc}}</td>
                       
                   </tr><br>

                   <tr>
                       
                       <td><b>Number of Terms in TUPC: Sem./Sum.:</b><br>
                       <td>{{s.number_of_terms_in_tupc}}</td>
                       
                   </tr><br>
                  
                 <tr>
                   <td><b>Amount Paid:</b></td><br>
                   <td>{{s.amount_paid}}</td>
               </tr><br>
               
                <tr>
                   <td><b>Official Receipt Number:</b></td><br>
                   <td>{{s.or_num}}</td>
               </tr><br>

              
              
               </div>
               <div class="column">
                
               <tr>
                   <td><b>Have you requested for the checked items below previously:</b></td><br>
                   <td>{% if i.have_previously_requested_form == "NO" %}
                       <label class="radio-inline">
                       <input class="my-1 mr-2" type="radio" name="requested_option_420" disabled id="reqYes_radio_42" value="YES" onclick="EnableDisableTextBox1()" oninput="enter_lastreqYes()" disabled>Yes
                       </label>
                           <label class="radio-inline">
                       <input class="my-1 mr-2" type="radio" name="requested_option_420" disabled id="reqNo_radio_42" value="NO" onclick="EnableDisableTextBox1()" oninput="enter_lastreqNo()" checked disabled>No
                       </label>
                       {% else %}
                       <label class="radio-inline">
                       <input class="my-1 mr-2" type="radio" name="requested_option_420" disabled id="reqYes_radio_42" value="YES" onclick="EnableDisableTextBox1()" oninput="enter_lastreqYes()"checked  disabled>Yes
                       </label>
                           <label class="radio-inline">
                       <input class="my-1 mr-2" type="radio" name="requested_option_420" disabled id="reqNo_radio_42" value="NO" onclick="EnableDisableTextBox1()" oninput="enter_lastreqNo()" disabled>No
                       </label>
                       {% endif %}</td>
               </tr><br>

               <tr>
                   <td><b>If yes, please indicate the date before its respective item(s):</b></td><br>
                   <td>{{s.date_of_previously_requested_form}}</td>
               </tr><br>
               <tr>
                   <td><b>Last Term in TUPC:</b></td><br>
                   <td>{{s.last_term_in_tupc}}</td>
               </tr><br>
               <tr>
                   <td><b>Purpose of Request:</b></td><br>
                   <td>{{s.purpose_of_request_reason}}</td>
               </tr><br>
               <tr>
                   <td><b>Course/ Shop Adviser:</b></td><br>
                   <td>{{s.course_adviser}}</td>
               </tr><br>

                
               </div>
             

            <div class="column">

               <tr>
                   <td><b>Clearance Requested for:</b></td><br>
                   <td>{{s.purpose_of_request}}</td>
                   </tr><br>
             
               <tr>
                 <td><b>Accountant:</b></td><br>
                 <td>
                   {% if s.accountant_signature == "UNAPPROVED" %}
                       <label >UNAPPROVED</label>
                   {% else %}
                       <label >APPROVED</label>
               {% endif %}</td>
             </tr><br>
             <tr>
               <td><b>Course/ Shop Adviser:</b></td><br>
               <td> 
                {% if "_UNAPPROVED" in s.course_adviser_signature %}
                   <label >UNAPPROVED</label>
                {% else %}
                   <label >APPROVED</label>
            {% endif %}</td>
               </tr><br>
             <tr>
                 <td><b>Head of Liberal Arts:</b></td><br>
                 <td>{% if s.liberal_arts_signature == "UNAPPROVED" %}
                   <label >UNAPPROVED</label>
               {% else %}
                   <label >APPROVED</label>
           {% endif %}</td>
             </tr><br>
             <tr>
                 <td><b>Campus Librarian:</b></td><br>
                 <td>{% if s.library_signature == "UNAPPROVED" %}
                   <label >UNAPPROVED</label>
               {% else %}
                   <label >APPROVED</label>
           {% endif %}</td>
             </tr><br>
             <tr>
                 <td><b>Head of Math and Science:</b></td><br>
                 <td>{% if s.mathsci_dept_signature == "UNAPPROVED" %}
                   <label >UNAPPROVED</label>
               {% else %}
                   <label >APPROVED</label>
           {% endif %}</td>
             </tr><br>
             </div>

             <div class="column">
               <tr>
                   <td><b>Guidance Counselor:</b></td><br>
                   <td>{% if s.guidance_office_signature == "UNAPPROVED" %}
                       <label >UNAPPROVED</label>
                   {% else %}
                       <label >APPROVED</label>
               {% endif %}</td>
               </tr><br>
               
             <tr>
               <td><b>Head of DPECS:</b></td><br>
               <td>{% if s.pe_dept_signature == "UNAPPROVED" %}
                   <label >UNAPPROVED</label>
               {% else %}
                   <label >APPROVED</label>
           {% endif %}</td>
               </tr><br>
               <tr>
                   <td><b>Head of Student Affairs:</b></td><br>
                   <td>{% if s.osa_signature == "UNAPPROVED" %}
                       <label >UNAPPROVED</label>
                   {% else %}
                       <label >APPROVED</label>
               {% endif %}</td>
               </tr><br>
               <tr>
                   <td><b> 
                   {% if it_department == 'EDUCATOR' %}
                       Head of Industrial Education Department:</b> 
                   {% elif it_department == 'TECHNOLOGIES' %}
                       Head of Industrial Technology Department:</b> 
                   {% elif it_department == 'ENGINEERS' %}
                       Head of Engineering Department:</b> 
                   {% else %}
                       Head of Industrial Technology/Industrial Education/Engineering:</b> 
                   {% endif %}</b></td><br>
                   <td>{% if s.it_dept_signature == "UNAPPROVED" %}
                       <label >UNAPPROVED</label>
                   {% else %}
                       <label >APPROVED</label>
               {% endif %}</td>
               </tr><br>
               <tr>
                   <td><b>Asst. DIR. for Academic Affairs::</b></td><br>
                   <td>{% if s.academic_affairs_signature == "UNAPPROVED" %}
                       <label >UNAPPROVED</label>
                   {% else %}
                       <label >APPROVED</label>
               {% endif %}</td>
               </tr><br>
               </div>
               {% endfor %}
           </div>
          </div>
          </div>
   </div>
        <p class="text-center text-bold" id="p6_52"></p>     
    </div>
    </hr>
    <p class="text-center text-bold" id="p6_52"></p>
    
    <!--CONFIRMATION MODAL FOR ESIGN-->
    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" id="mi-modal">
        <div class="modal-dialog modal-md modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #424242;">
                    <h4 class="modal-title" id="myModalLabel" style="color: white; font-size: 20px;">Confirmation</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color:white;"><span aria-hidden="true">&times;</span></button>
                </div>
                <div class="modal-body" style=" text-align: center; padding: 20px; font-size: 18px;">
                    You are about to sign the selected form/s. This process cannot be undone.<br><b>Do you want to continue?</b>
                </div>
                <div class="modal-footer" style="background-color:#c31d35">
                    <button type="button" class="btn" id="yes_esign" style="background-color: #424242; color: white; padding-left: 1vw; padding-right: 1vw;">Continue</button>
                    <button type="button" class="btn" id="no_esign" style="background-color: #e7dfe4; color: #c31d35; padding-left: 1vw; padding-right: 1vw;">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!--CONFIRMATION FOR MANUALLY-->
    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" id="mi-modal3">
        <div class="modal-dialog modal-md modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #424242;">
                    <h4 class="modal-title" id="myModalLabel" style="color: white; font-size: 20px;">Confirmation</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color:white;"><span aria-hidden="true">&times;</span></button>
                </div>
                <div class="modal-body" style=" text-align: center; padding: 20px; font-size: 18px;">
                    You are about to sign the selected form/s. This process cannot be undone.<br><b>Do you want to continue?</b>
                </div>
                <div class="modal-footer" style="background-color:#c31d35">
                    <button type="button" class="btn" id="yes_manually" style="background-color: #424242; color: white; padding-left: 1vw; padding-right: 1vw;">Continue</button>
                    <button type="button" class="btn" id="no_manually" style="background-color: #e7dfe4; color: #c31d35; padding-left: 1vw; padding-right: 1vw;">Cancel</button>
                </div>
            </div>
        </div>
    </div>
</body>




<footer  id="footer_bottom">
    <div id="footer_div">
        <p>© Technological University of the Philippines-Cavite</p>
    </div>
    
</footer>


</html>
<script>
    if(document.getElementById("id_determiner") != 0){
        document.getElementById("myDIV").hidden = false;
    }else{
        document.getElementById("myDIV").hidden = true;
    };

    // function myFunction() {
    //   var x = document.getElementById("myDIV");
    //   if (x.style.display === "none") {
    //     x.style.display = "block";
    //   } else {
    //     x.style.display = "none";
    //   }
    // }
    // </script>

<script>

        //SORTING
    function sortTableByColumn(table, column, asc = true) {
        const dirModifier = asc ? 1 : -1;
        const tBody = table.tBodies[0];
        const rows = Array.from(tBody.querySelectorAll("tr"));

        // Sort each row
        const sortedRows = rows.sort((a, b) => {
            const aColText = a.querySelector(`td:nth-child(${ column + 1 })`).textContent.trim();
            const bColText = b.querySelector(`td:nth-child(${ column + 1 })`).textContent.trim();

            return aColText > bColText ? (1 * dirModifier) : (-1 * dirModifier);
        });

        // Remove all existing TRs from the table
        while (tBody.firstChild) {
            tBody.removeChild(tBody.firstChild);
        }

        // Re-add the newly sorted rows
        tBody.append(...sortedRows);

        // Remember how the column is currently sorted
        table.querySelectorAll("th").forEach(th => th.classList.remove("th-sort-asc", "th-sort-desc"));
        table.querySelector(`th:nth-child(${ column + 1})`).classList.toggle("th-sort-asc", asc);
        table.querySelector(`th:nth-child(${ column + 1})`).classList.toggle("th-sort-desc", !asc);
    }

    document.querySelectorAll(".table-sortable .sorting").forEach(headerCell => {
        headerCell.addEventListener("click", () => {
            const tableElement = headerCell.parentElement.parentElement.parentElement;
            const headerIndex = Array.prototype.indexOf.call(headerCell.parentElement.children, headerCell);
            const currentIsAscending = headerCell.classList.contains("th-sort-asc");

            sortTableByColumn(tableElement, headerIndex, !currentIsAscending);
        });
    });
  
    // DISPLAY NO DATA WHEN TABLE IS EMPTY
    var dattable = document.getElementById("list_tbl_52");
    var rowcount = dattable.tBodies[0].rows.length;

    if (rowcount == '0') {
        $('.no_data').show();
        $('.no-result').hide();
    } else {
        $('.no_data').hide();
        $('.no-result').hide();
    }

    //SIGNATURE
    var canvas = document.getElementById("signature_pad");
    function resizeCanvas() {
        var ratio = Math.max(window.devicePixelRatio || 1, 1);
        canvas.width = canvas.offsetWidth * ratio;
        canvas.height = canvas.offsetHeight * ratio;
        canvas.getContext("2d").scale(ratio, ratio);
    }
    window.onresize = resizeCanvas;
    resizeCanvas();

    var signaturePad = new SignaturePad(canvas, {
     backgroundColor: 'rgb(255,255,255,0)'
    });
    
    document.getElementById("clear").addEventListener('click', function(){
     signaturePad.clear();
    });

    const save_signature = document.querySelector('#save_signature');
    const signature_pad = document.querySelector('#signature_pad');

    const ctx = signature_pad.getContext("2d");

    signature_pad.addEventListener("touchend", function() {
        const dataURI = signature_pad.toDataURL("image/png");
        
        console.log(dataURI);
        document.getElementById('image_encoded').value = dataURI;
    });
    
    signature_pad.addEventListener("mouseup", function() {
        const dataURI = signature_pad.toDataURL("image/png");
        
        console.log(dataURI);
        document.getElementById('image_encoded').value = dataURI;
    });

    //SHOW CREATE SIGNATURE AREA
    edit_esign_btn.addEventListener("click", function() {
        document.getElementById("create_signature_area").hidden = false;
        document.getElementById("button_area").hidden = true;
        document.getElementById("show_details").hidden = true;
        document.getElementById("create_new_button").hidden = false;
        document.getElementById("upload_new_button").hidden = false;
    });

    create_new_esign.addEventListener("click", function() {
        document.getElementById("create_new_esignature").hidden = false;
        document.getElementById("signature_pad").width = 350;
        document.getElementById("signature_pad").height = 200;
        document.getElementById("submit_signature").hidden = false;
        document.getElementById("button_area").hidden = true;
        document.getElementById("show_details").hidden = true;
        document.getElementById("create_new_button").hidden = true;
        document.getElementById("upload_new_button").hidden = true;
    });

    upload_new_esign.addEventListener("click", function() {
        document.getElementById("create_signature_area").hidden = false;
        document.getElementById("upload_signature_area").hidden = false;
        document.getElementById("submit_signature").hidden = false;
        document.getElementById("button_area").hidden = true;
        document.getElementById("show_details").hidden = true;
        document.getElementById("create_new_button").hidden = true;
        document.getElementById("upload_new_button").hidden = true;
    });

    cancel_create.addEventListener("click", function() {
        document.getElementById("create_signature_area").hidden =false;
        document.getElementById("submit_signature").hidden = true;
        document.getElementById("upload_signature_area").hidden = true;
        signaturePad.clear();
        document.getElementById('image_encoded').value = "";
        document.getElementById("button_area").hidden = true;
        document.getElementById("show_details").hidden = true;
        document.getElementById("create_new_esignature").hidden = true;
        document.getElementById("create_new_button").hidden = false;
        document.getElementById("upload_new_button").hidden = false;
    });

    cancel_upload.addEventListener("click", function() {
        document.getElementById("upload_signature_area").hidden = true;
        document.getElementById("submit_signature").hidden = true;
        document.getElementById('uploaded_signature_new').value =null;
        document.getElementById('preview').src ="";
        document.getElementById("button_area").hidden = true;
        document.getElementById("show_details").hidden = true;
        document.getElementById("create_signature_area").hidden =false;
        document.getElementById("create_new_button").hidden = false;
        document.getElementById("upload_new_button").hidden = false;
    });

    cancel_edit_digtal.addEventListener("click", function() {
        document.getElementById("upload_signature_area").hidden = true;
        document.getElementById("submit_signature").hidden = true;
        document.getElementById('uploaded_signature_new').value =null;
        document.getElementById('preview').src ="";
        document.getElementById("button_area").hidden = false;
        document.getElementById("show_details").hidden = false;
        document.getElementById("create_signature_area").hidden =true;
        document.getElementById("create_new_button").hidden = true;
        document.getElementById("upload_new_button").hidden = true;
    });
    
    var loadFile = function(event) {
        var image = document.getElementById('preview');
        image.src=URL.createObjectURL(event.target.files[0]);
    };
    //CLOSE SIGNATURE SECTION WHEN NOT NEEDED
    function close_boxes(elem){
        document.getElementById("signature_section").style.width = "0";
        document.getElementById("table_list").style.marginRight= "0";
    }
    
    //OPEN APPROVAL SIGNATURE SECTION
    function OpenSignature(elem){
        if (window.innerWidth < 500){
            document.getElementById("signature_section").style.width = "100vw";
            document.getElementById("table_list").style.marginRight = "100vw"; 
        }else{
            document.getElementById("signature_section").style.width = "400px";
            document.getElementById("table_list").style.marginRight = "400px"; 
        }
        
        document.getElementById("table_list").style.opacity = "0.5";
        
        var array = []
        var checkboxes = document.querySelectorAll('input[name=boxes]:checked')

        for (var i = 0; i < checkboxes.length; i++) {
        array.push(checkboxes[i].value)
        }
        document.getElementById('id_list').value= array;
        
        //DISABLED  BURRONS AND CHECKBOXES WHEN APPROVE IN TABLE CLICKED
        var button_approve = document.getElementsByClassName("user_id apprv");
        for (var i = 0; i < button_approve.length; i++) {
            button_approve[i].disabled = true;
            button_approve[i].style.opacity = "0.5";
        }

        var checkboxes_approve = document.getElementsByClassName("check")
        for(var index = 0; index < checkboxes_approve.length; index++){
            checkboxes_approve[index].disabled = true;
        }
    };

    function department1(elem){
        document.getElementById('department').value = "accountant_signature";
    };

    function department2(elem){
        document.getElementById('department').value = "mathsci_dept_signature";
    };

    function department3(elem){
        document.getElementById('department').value = "pe_dept_signature";
    };

    function department4(elem){
        document.getElementById('department').value = "ieduc_dept_signature";
    };

    function department5(elem){
        document.getElementById('department').value = "it_dept_signature";
    };

    function department6(elem){
        document.getElementById('department').value = "eng_dept_signature";
    };
    function department7(elem){
        document.getElementById('department').value = "library_signature";
    };
    function department8(elem){
        document.getElementById('department').value = "guidance_office_signature";
    };

    function department9(elem){
        document.getElementById('department').value = "osa_signature";
    };

    function department10(elem){
        document.getElementById('department').value = "academic_affairs_signature";
    };

    function department11(elem){
        document.getElementById('department').value = "course_adviser_signature";
    };

    function department12(elem){
        document.getElementById('department').value = "liberal_arts_signature";
    };

    const handleClick = ({ target }) => {
        if (target.classList.contains('user_id')) {
          const row = target.closest('tr');
          const id = row.querySelector('.nr').textContent.trim();
          const name = row.querySelector('.name').textContent.trim();
          const request = row.querySelector('.request').textContent.trim();
          document.getElementById('attach_signature_to').value = id;
          
        }
    };
    document.querySelector('table').addEventListener('click', handleClick);
    
    //CONFIRM SUBMIT FOR E SIGNATURE
    var modalConfirm = function(callback){
  
        $("#esign_attach_sig_btn").on("click", function(){
            if (document.getElementById('esign_checker').value == "" && document.getElementById('upload_checker').value == ""){
                document.getElementById("create_signature_area").hidden = false;
                document.getElementById("button_area").hidden = true;
                document.getElementById("show_details").hidden = true;
                document.getElementById("create_new_button").hidden = false;
                document.getElementById("upload_new_button").hidden = false;
            }else{
                $("#mi-modal").modal('show');
            }
        });
      
        $("#yes_esign").on("click", function(){
          callback(true);
          $("#mi-modal").modal('hide');
        });
        
        $("#no_esign").on("click", function(){
          callback(false);
          $("#mi-modal").modal('hide');
        });
    };
      
    modalConfirm(function(confirm){
        if(confirm){
            esign_approved()
        }else{
            return false;
        }
    });

    function esign_approved(){
        id_list = document.getElementById('id_list').value;
        var id_user = document.getElementById('attach_signature_to').value;
        var dept = document.getElementById('department').value;
        var sig = "ESIGN";
        if (id_list.length != 0){
            document.getElementById('id_list').value = id_list
            document.getElementById('sig').value= sig
            document.getElementById("submit_btn_all").click()
        }  
        else {
            location.href = "update_clearance/"+id_user+"/"+dept+"/"+sig;
        }
    };
     
    //CONFIRM SUBMIT MANNUALY APPROVE
    var modalConfirm = function(callback){
  
        $("#approve_sig_btn").on("click", function(){
          $("#mi-modal3").modal('show');
        });
      
        $("#yes_manually").on("click", function(){
          callback(true);
          $("#mi-modal3").modal('hide');
        });
        
        $("#no_manually").on("click", function(){
          callback(false);
          $("#mi-modal3").modal('hide');
        });
    };
      
    modalConfirm(function(confirm){
        if(confirm){
            approve_only()
        }else{
            return false;
        }
    });

    function approve_only() {
        id_list = document.getElementById('id_list').value;
        var id_user = document.getElementById('attach_signature_to').value;
        var dept = document.getElementById('department').value;
        var sig = "APPROVE";
        if (id_list.length != 0){
            document.getElementById('id_list').value = id_list
            document.getElementById('sig').value= sig
            document.getElementById("submit_btn_all").click()
        }  
        else {
        location.href = "update_clearance/"+id_user+"/"+dept+"/"+sig;
        }
    };


    close_signature.addEventListener("click", function() {
        document.getElementById("signature_section").style.width = "0";
        document.getElementById("table_list").style.marginRight= "0";
        document.getElementById("table_list").style.opacity = "1";
        document.getElementById("button_area").hidden = false;
        document.getElementById("show_details").hidden = false;
        document.getElementById("create_signature_area").hidden = true;
        document.getElementById("create_new_esignature").hidden = true;
        document.getElementById("upload_signature_area").hidden = true;
        document.getElementById("submit_signature").hidden = true;
        
        var checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
        if(checkboxes.length == 0){
            var button_approve = document.getElementsByClassName("user_id apprv");
            for (var i = 0; i < button_approve.length; i++) {
                button_approve[i].disabled = false;
                button_approve[i].style.opacity = "1";
            }
            
            var checkboxes_approve = document.getElementsByClassName("check")
            for(var index = 0; index < checkboxes_approve.length; index++){
                checkboxes_approve[index].disabled = false;
            }
        }else{
            var button_approve = document.getElementsByClassName("user_id approve_all");
            for (var i = 0; i < button_approve.length; i++) {
                button_approve[i].disabled = false;
                button_approve[i].style.opacity = "1";
            }
            
            var checkboxes_approve = document.getElementsByClassName("check")
            for(var index = 0; index < checkboxes_approve.length; index++){
                checkboxes_approve[index].disabled = false;
            }
        }
        
    });

    
    //CHANGE BUTTON TEXT ONCE SIGNATURE IS NONE
    if(document.getElementById('esign_checker').value == "" && document.getElementById('upload_checker').value == ""){
        document.getElementById('esign_attach_sig_btn').textContent = "CREATE OR ATTACH DIGITAL SIGNATURE";
        document.getElementById('upload_new_esign').textContent = "Attach Image of Digital Signature";
        document.getElementById('create_new_esign').textContent = "Create Digital Signature";
    }else{
        document.getElementById('new_signature_text').innerHTML = "CREATE NEW E-SIGNATURE";
        document.getElementById('upload_text').innerHTML = "UPLOAD NEW SIGANTURE";
    };

    function openfdb() {
        window.location.replace("{% url 'faculty_dashboard' %}");
    }

    function openfdbc() {
        window.location.replace("{% url 'faculty_dashboard_clearance_list' id=0 %}");
    }

    // TAB JS
    var items = document.querySelectorAll('#tabz_52');
    for (var i = 0, len = items.length; i < len; i++) {
        (function() {
                var t, e = this,
                    a = "[data-tab]",
                    n = document.body,
                    r = n.matchesSelector || n.webkitMatchesSelector || n.mozMatchesSelector || n.msMatchesSelector,
                    o = function() {
                        var a = e.querySelectorAll("[data-tab-content]") || [];
                        for (t = 0; t < a.length; t++) a[t].style.display = "none"
                    },
                    i = function(n) {
                        var r = e.querySelectorAll(a) || [];
                        for (t = 0; t < r.length; t++) {
                            var i = r[t],
                                s = i.className.replace("tab-active", "").trim();
                            i.className = s
                        }
                        o(), n.className += " tab-active";
                        var l = n.getAttribute("href"),
                            c = e.querySelector(l);
                        c && (c.style.display = "")
                    },
                    s = e.querySelector(".tab-active" + a);
                s = s || e.querySelector(a), s && i(s), e.addEventListener("click", function(t) {
                    var e = t.target;
                    r.call(e, a) && i(e)
                })
            }
            .bind(items[i]))();
    }

    // TO APPROVE STUDENT
    function deleteRow(r) {
        var i = r.parentNode.parentNode.rowIndex;
        document.getElementById("list_tbl_52").deleteRow(i);
        swal({
            title: "Done",
            text: "Application Approved!",
            icon: "success",
            button: "Ok",
        })
    }

    // TRIGGER ENTER BUTTON
    $("#search_box_52").keyup(function(event) {
        if (event.keyCode === 13) {
            $("#search_btn_52").click();
        }
    });

    // DISALLOW FIRST SPACES IN INPUT BOX JS
    $(function() {
        $('body').on('keydown', '#search_box', function(e) {
            if (e.which === 32 && e.target.selectionStart === 0) {
                return false;
            }
        });
    });

    //MULTIPLE SPACE REMOVER
    $(function() {
        var txt1 = $("#search_box_52");
        var func = function() {
            txt1.val(txt1.val().replace(/\s\s+/g, ' '));
        }
        txt1.keyup(func).blur(func);
    });

    // BACK TO TOP FUNCTION
    var btn = $("#backtotop_btn_52");

    $(window).scroll(function() {
        if ($(window).scrollTop() > 300) {
            btn.addClass("show");
        } else {
            btn.removeClass("show");
        }
    });

    btn.on("click", function(e) {
        e.preventDefault();
        $("html, body").animate({
            scrollTop: 0
        }, "300");
    });

    // SEARCH1
    function searching1() {
        $(document).ready(function() {
            $(".search").keyup(function() {
                var searchTerm = $(".search").val();
                var listItem = $('.results tbody').children('tr');
                var searchSplit = searchTerm.replace(/ /g, "'):containsi('")

                $.extend($.expr[':'], {
                    'containsi': function(elem, i, match, array) {
                        return (elem.textContent || elem.innerText || '').toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
                    }
                });

                $(".results tbody tr").not(":containsi('" + searchSplit + "')").each(function(e) {
                    $(this).attr('visible', 'false');
                });

                $(".results tbody tr:containsi('" + searchSplit + "')").each(function(e) {
                    $(this).attr('visible', 'true');
                });

                var jobCount = $('.results tbody tr[visible="true"]').length;
                $('.counter').text(jobCount + ' item');

                if (jobCount == '0') {
                    $('.no-result').show();
                    $('.no_data').hide();
                } else {
                    $('.no-result').hide();
                }
            });
        });
    }

    // SEARCH2
    function searching2() {
        $(document).ready(function() {
            $(".search").keyup(function() {
                var searchTerm = $(".search").val();
                var listItem = $('.results tbody').children('tr');
                var searchSplit = searchTerm.replace(/ /g, "'):containsi('")

                $.extend($.expr[':'], {
                    'containsi': function(elem, i, match, array) {
                        return (elem.textContent || elem.innerText || '').toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
                    }
                });

                $(".results tbody tr").not(":containsi('" + searchSplit + "')").each(function(e) {
                    $(this).attr('visible', 'false');
                });

                $(".results tbody tr:containsi('" + searchSplit + "')").each(function(e) {
                    $(this).attr('visible', 'true');
                });

                var jobCount = $('.results tbody tr[visible="true"]').length;
                $('.counter').text(jobCount + ' item');

                if (jobCount == '0') {
                    $('.no-result').show();
                    $('.no_data').hide();
                } else {
                    $('.no-result').hide();
                }
            });
        });
    }

    // SORTING 

    function sortTable(table, col, reverse) {
        var tb = table.tBodies[0], 
            tr = Array.prototype.slice.call(tb.rows, 0), // put rows into array
            i;
        reverse = -((+reverse) || -1);
        tr = tr.sort(function (a, b) { // sort rows
            return reverse // `-1 *` if want opposite order
                * (a.cells[col].textContent.trim() // using `.textContent.trim()` for test
                    .localeCompare(b.cells[col].textContent.trim())
                   );
        });
        for(i = 0; i < tr.length; ++i) tb.appendChild(tr[i]); // append each row in order
    }
    
    function makeSortable(table) {
        var th = table.tHead, i;
        th && (th = th.rows[0]) && (th = th.cells);
        if (th) i = th.length;
        else return; // if no thead then do nothing
        while (--i >= 0) (function (i) {
            var dir = 1;
            th[i].addEventListener('click', function () {sortTable(table, i, (dir = 1 - dir))});
        }(i));
    }
    
    function makeAllSortable(parent) {
        parent = parent || document.body;
        var t = parent.getElementsByTagName('table'), i = t.length;
        while (--i >= 0) makeSortable(t[i]);
    }
    
    window.onload = function () {makeAllSortable();};

    // REFRESH TABLE WHEN SEARCH X BUTTON PRESSED
    function OnSearch(input) {
        location.reload();
    }


    // PREVENT SCROLLING WHILE SWITCHING TABS
    $('#tabz_52 a').click(function(e) {
        e.preventDefault();
        $(this).tab('show');

        var checked = $(this).find('input').prop('checked');
        $(this).find('input').prop('checked', !checked);
    });

    // RESET SEARCH BAR WHEN BACK BUTTON PRESSED
    $(window).bind("pageshow", function() {

        document.getElementById("search_box_52").value = "";
    });
   
</script>

<!-- DISABLE BACK BUTTON ON BROWSER -->
<script type = "text/javascript" >  
    function preventBack() { window.history.forward(); }  
    setTimeout("preventBack()", 0);  
    
</script> 
<script>
    $("appr_btn").on("click", function () {
    $("tr").each(function () {
        $(this).removeClass("highlight");
    });
    $(this).closest("tr").addClass("highlight");
}); 
    
    //CHECKBOXES IN TABLE
    function checkAll(ele) {
    var checkboxes = document.getElementsByTagName('input');
    if (ele.checked) {
        for (var i = 0; i < checkboxes.length; i++) {
            if (checkboxes[i].type == 'checkbox') {
                checkboxes[i].checked = true;
            }
        }
    } else {
        for (var i = 0; i < checkboxes.length; i++) {
            console.log(i)
            if (checkboxes[i].type == 'checkbox') {
                checkboxes[i].checked = false;
            }
        }
    }
    }

    // DISABLE APPROVE ALL BUTTON WHEN CHECKBOXES CHECKED
    $(function(){
    $("input[type='checkbox']").change(function(){
        var len = $("input[type='checkbox']:checked").length;
        if(len == 0)
            $("button[name='approve_all']").prop("disabled", true);
            
        else
            $("button[name='approve_all']").removeAttr("disabled");
            
    });
    $("input[type='checkbox']").trigger('change');
    });

    // LOW OPACITY OF APPROVE ALL WHEN DISABLED
    $(function(){
    $("input[type='checkbox']").change(function(){
        var len = $("input[type='checkbox']:checked").length;
        if(len == 0)
            $("button[name='approve_all']").css('opacity', '0.5');
        else
            $("button[name='approve_all']").css('opacity', '1');
    });
    $("input[type='checkbox']").trigger('change');
    });

    // DISABLE SINGLE APPROVE BUTTONS IF CHECKBOXES CHECKED
    $(function(){
    $("input[type='checkbox']").change(function(){
        var len = $("input[type='checkbox']:checked").length;
        if(len == 0)
            $("button[class='button user_id apprv']").prop("disabled", false);
            
        else
        $("button[class='button user_id apprv']").prop("disabled", true);
            
    });
    $("input[type='checkbox']").trigger('change');
    });

    // LOW OPACITY OF SINGLE APPROVE BTN WHEN DISABLED
    $(function(){
    $("input[type='checkbox']").change(function(){
        var len = $("input[type='checkbox']:checked").length;
        if(len == 0)
            $("button[class='button user_id apprv']").css('opacity', '1');
        else
            $("button[class='button user_id apprv']").css('opacity', '0.5');
    });
    $("input[type='checkbox']").trigger('change');
    });
</script>